<!--

 var upload = $("#lol")[0];
var im = $("#im");

 var file,
      reader = new FileReader();

  reader.onload = function (event) {
      //alert();
    var f = event.target.result;
      
      alert(f+":"+ $(f).find("id").text());
    for(var i in f){
       // console.log(i, ":", f[i]);
    }
    //  var img = new Image();
   // img.src = event.target.result;
    //  im.append(img);
  };

$("#lol").change(function(event){
    var f = upload.files[0];
    for(var i in f);
//        console.log(i, ":", f[i]);
    
    reader.readAsText(f);
    //reader.readAsArrayBuffer(f);
   // reader.readAsBinaryString(f);
   // reader.readAsDataURL(f);
    
});


-->

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset=utf-8>
<meta name="viewport" content="width=620">
<title>HTML5 Demo: File API (simple)</title>
<link rel="stylesheet" href="css/html5demos.css">
<script src="js/h5utils.js"></script></head>
<body>
<section id="wrapper">
<div id="carbonads-container"><div class="carbonad"><div id="azcarbon"></div><script type="text/javascript">var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = "http://engine.carbonads.com/z/14060/azcarbon_2_1_0_VERT"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script></div></div>
    <header>
      <h1>File API (simple)</h1>
    </header>

<article>
  <p id="status">File API & FileReader API not supported</p>
  <p><input type=file></p>
  <p>Select an image from your machine to read the contents of the file without using a server</p>
  <div id="holder"></div>
</article>
<script>
var upload = document.getElementsByTagName('input')[0],
    holder = document.getElementById('holder'),
    state = document.getElementById('status');

if (typeof window.FileReader === 'undefined') {
  state.className = 'fail';
} else {
  state.className = 'success';
  state.innerHTML = 'File API & FileReader available';
}

 var file,
      reader = new FileReader();
  reader.onload = function (event) {
    var img = new Image();
    img.src = event.target.result;
    // note: no onload required since we've got the dataurl...I think! :)
    if (img.width > 560) { // holder width
      img.width = 560;
    }
    holder.innerHTML = '';
    holder.appendChild(img);
  };

upload.onchange = function (e) {
  e.preventDefault();

  file = upload.files[0]


  jsonFormatter(upload, 1, 1);
  alert(file)
  
  reader.readAsDataURL(file);

  return false;
};





function raport(arg){
  arg = arg.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\n/g, "<br/>").replace(/\t/g, "&nbsp; &nbsp;");
  document.getElementById("raport").innerHTML +=arg; //+ "----"+ typeof(arg)
}
function getType(arg){
  var tmp = Object.prototype.toString.call(arg);

  return tmp.substring(8, tmp.length-1).toLowerCase();
}
function jsonFormatter(json, humanFreiendly, wannaLog){
  if(isEmpty(json))
    console.log("Nieprawid≈Çowy argument");

  var objSymbols = ["{","}"],
    tabSymbols = ["[","]"],
    output = ["{\n" ],
    seenObjects = [json],
    value,
    type,
    tmp,
    stringified
  ;

  function hasBeenSeenBefore(obj){
    var result = false;
    for(var i = 0, j = seenObjects.length; i<j; i++){
      if(obj === seenObjects[i]){
        result = true;
        break;
      }
    }

    return result;
  }

  function inner(json, tabulacja, first){
    var symbols;
    tabulacja = tabulacja || "";
    tabulacja+="\t";

    for(var i in json){
      if(json.hasOwnProperty(i)){
        value = json[i];
        type = getType(value)
        // console.log(i, json[i])
        switch(type){
          case "object" :
          case "array" :
            symbols = (type === "object" ? objSymbols : tabSymbols);
            if( !isEmpty(value) ){
              if( first || !hasBeenSeenBefore(value) ){
                stringified = value.toString()
                if(stringified === "Rapha\xebl\u2019s object"){
                  output.push(tabulacja+(i)+" : [ Rapha\xebl\u2019s object ],\n");
                }
                else if(stringified === "SSDL_Node object"){
                  output.push(tabulacja+(i)+" : [ SSDL_Node object ],\n");
                }
                else if(stringified === "SSDL_CFEdge object"){
                  output.push(tabulacja+(i)+" : [ SSDL_CFEdge object ],\n");
                }
                else if(stringified === "SSDL_DFEdge object"){
                  output.push(tabulacja+(i)+" : [ SSDL_DFEdge object ],\n");
                }
                else if(stringified === "bottomBar_Option object"){
                  output.push(tabulacja+(i)+" : [ bottomBar_Option object ],\n");
                }
                else if(stringified === "bottomBar_Group object"){
                  output.push(tabulacja+(i)+" : [ bottomBar_Group object ],\n");
                }
                else {
                  output.push(tabulacja+(i)+" : "+symbols[0]+"\n");
                  output.push( inner(value, tabulacja+"\t") );
                  output.push(tabulacja+symbols[1]+",\n");
                }
                seenObjects.push(value);
              } else {
                output.push(tabulacja+(i)+" : (objectSeenBefore),\n");
              }
            }
            else
              output.push(tabulacja+(i)+" : "+ symbols[0] + symbols[1]+",\n" );
          break;
          case "string" :
            output.push(tabulacja+(i)+" : "+(value ? ("\""+value+"\"") : "(an empty string)")+",\n");
          break;
          case "number" :
            output.push(tabulacja+(i)+" : "+value+",\n");
          break;
          case "regexp" :
            output.push(tabulacja+(i)+" : /"+value.source+"/,\n");
          break;
          case "function" :
            tmp = value.toLocaleString();
            output.push(tabulacja+(i)+" : "+tmp.substring(0, tmp.indexOf(")")+1)+"{...},\n");
          break;
          case "undefined" :
          case "null":
          case "boolean" :
            output.push(tabulacja+(i)+" : "+value+",\n");
          break;
        }

      }
        
    }

    tmp = output[ output.length-1 ];
    output[ output.length-1 ] = tmp.substring(0, tmp.length-2)+"\n"

  };
  inner(json, "", true);

  output.push("}\n");

  var outputString = output.join("");

  if(!humanFreiendly){
    outputString = outputString.replace(/\t/g, "").replace(/\n/g, "");
  }

  if(wannaLog){
    console.log(outputString);
  }

  return outputString;
}
function isEmpty(obj){
  var result = false
    type = getType(obj)
  ;
  if(type == "object" || type =="array"){
    result = true;
    for(var i in obj){
      if(obj.hasOwnProperty(i)){
        result = false;
        break;
      }
    }
  }

  return result;
}
</script>
<a id="html5badge" href="http://www.w3.org/html/logo/">
<img src="http://www.w3.org/html/logo/badge/html5-badge-h-connectivity-device-graphics-multimedia-performance-semantics-storage.png" width="325" height="64" alt="HTML5 Powered with Connectivity / Realtime, Device Access, Graphics, 3D & Effects, Multimedia, Performance & Integration, Semantics, and Offline & Storage" title="HTML5 Powered with Connectivity / Realtime, Device Access, Graphics, 3D & Effects, Multimedia, Performance & Integration, Semantics, and Offline & Storage">
</a>
    <footer><a href="/">HTML5 demos</a>/<a id="built" href="http://twitter.com/rem">@rem built this</a>/<a href="#view-source">view source</a></footer> 
</section>
<a href="http://github.com/remy/html5demos"><img style="position: absolute; top: 0; left: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png" alt="Fork me on GitHub" /></a>
<script src="js/prettify.packed.js"></script>
<script>
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>
try {
var pageTracker = _gat._getTracker("UA-1656750-18");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>